<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LinkedIn Demo Importer - PF-ADS</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .post { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px; }
    button { background: #0077b5; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
    textarea { width: 100%; height: 150px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>üì• –ò–º–ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è PF-ADS</h1>
  
  <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0;">
    <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong> LinkedIn API —Ç—Ä–µ–±—É–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞. 
    –ü–æ–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–æ–≤ –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–µ–º–æ-–∫–æ–Ω—Ç–µ–Ω—Ç.
  </div>

  <button onclick="loadDemoPosts()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ–º–æ-–ø–æ—Å—Ç—ã</button>
  <button onclick="showManualForm()">‚úèÔ∏è –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç –≤—Ä—É—á–Ω—É—é</button>

  <div id="postsContainer" style="margin-top: 20px;"></div>
  <div id="manualForm" style="display: none; margin-top: 20px;"></div>

  <script>
    async function loadDemoPosts() {
      try {
        const response = await fetch('/functions/linkedin-rss', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            action: 'import_from_rss'
          })
        });

        const result = await response.json();
        
        if (result.success) {
          displayPosts(result.posts);
        } else {
          alert('Error: ' + result.error);
        }
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }

    function displayPosts(posts) {
      const container = document.getElementById('postsContainer');
      container.innerHTML = '<h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ—Å—Ç—ã:</h3>';
      
      posts.forEach((post, index) => {
        const postDiv = document.createElement('div');
        postDiv.className = 'post';
        postDiv.innerHTML = `
          <h4>${post.title}</h4>
          <p>${post.content.replace(/\n/g, '<br>')}</p>
          <small>–î–∞—Ç–∞: ${new Date(post.date).toLocaleDateString()}</small>
          <br>
          <button onclick="publishPost(${index})">üìÑ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–æ—Å—Ç</button>
        `;
        container.appendChild(postDiv);
      });
    }

    function showManualForm() {
      const formDiv = document.getElementById('manualForm');
      formDiv.style.display = 'block';
      formDiv.innerHTML = `
        <h3>–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç –≤—Ä—É—á–Ω—É—é</h3>
        <div>
          <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫:</label><br>
          <input type="text" id="manualTitle" style="width: 100%; padding: 8px; margin: 5px 0;" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫">
        </div>
        <div>
          <label>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:</label><br>
          <textarea id="manualContent" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ—Å—Ç–∞..."></textarea>
        </div>
        <button onclick="createManualPost()">‚úÖ –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</button>
      `;
    }

    async function createManualPost() {
      const title = document.getElementById('manualTitle').value;
      const content = document.getElementById('manualContent').value;
      
      if (!title || !content) {
        alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
        return;
      }

      const date = new Date().toISOString().split('T')[0];
      const slug = title.toLowerCase().replace(/[^a-z0-9–∞-—è—ë]+/g, '-').replace(/-+/g, '-').replace(/^-|-$/g, '');
      const filename = `${date}-${slug}.md`;
      
      const postContent = `---
title: "${title.replace(/"/g, '\\"')}"
date: ${new Date().toISOString()}
---
${content}
`;

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
      const container = document.getElementById('postsContainer');
      container.innerHTML = `
        <h3>‚úÖ –ü–æ—Å—Ç –≥–æ—Ç–æ–≤ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏!</h3>
        <div class="post">
          <h4>${title}</h4>
          <p>${content.replace(/\n/g, '<br>')}</p>
          <p><strong>–ò–º—è —Ñ–∞–π–ª–∞:</strong> ${filename}</p>
          <textarea style="width: 100%; height: 200px; margin: 10px 0;">${postContent}</textarea>
          <br>
          <a href="https://github.com/AleksandrPepeslavtcev/pf-ads-site/new/main/_posts" target="_blank" style="background: #2ea44f; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;">
            üìù –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ GitHub
          </a>
        </div>
      `;
    }

    function publishPost(index) {
      alert(`–ü–æ—Å—Ç ${index} –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω. –í —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–¥ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ GitHub API.`);
    }
  </script>
</body>
</html>
