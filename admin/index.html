<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PF-ADS CMS</title>
  
  <!-- –ó–∞–≥—Ä—É–∑–∫–∞ CMS —á–µ—Ä–µ–∑ CDN -->
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  
  <style>
    /* –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π –∏ –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #fff;
      height: 100vh;
      overflow: hidden;
    }
    
    #nc-root {
      height: 100vh;
      width: 100vw;
    }
    
    .loading-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .error-container {
      padding: 40px;
      text-align: center;
      background: #ffebee;
      color: #c62828;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    
    .btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      margin: 10px;
      font-size: 16px;
      text-decoration: none;
      display: inline-block;
    }
    
    .btn:hover {
      background: #5a67d8;
    }
  </style>
</head>
<body>
  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è CMS (–î–û–õ–ñ–ï–ù –°–£–©–ï–°–¢–í–û–í–ê–¢–¨) -->
  <div id="nc-root"></div>

  <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <div id="loadingState" class="loading-container">
    <h1>PF-ADS Content Manager</h1>
    <p>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º...</p>
    <div style="margin-top: 20px;">
      <div style="width: 40px; height: 40px; border: 4px solid #fff; border-top: 4px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;"></div>
    </div>
  </div>

  <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–∫–∏ -->
  <div id="errorState" class="error-container" style="display: none;">
    <h2>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h2>
    <p style="margin: 20px 0; max-width: 500px;">
      –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ GitHub OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π —Å–∫—Ä–∏–ø—Ç–æ–≤.
    </p>
    <div>
      <button class="btn" onclick="window.location.reload()">üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
      <a class="btn" href="/" style="background: #718096;">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
      <button class="btn" onclick="showDebugInfo()" style="background: #4a5568;">üêõ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏</button>
    </div>
    <div id="debugInfo" style="display: none; margin-top: 20px; text-align: left; background: white; padding: 15px; border-radius: 5px; color: #2d3748;">
      <h4>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:</h4>
      <p><strong>Repo:</strong> AleksandrPepeslavtcev/pf-ads-site</p>
      <p><strong>Branch:</strong> main</p>
      <p><strong>Domain:</strong> https://www.pf-ads.com</p>
      <p><strong>Callback URL:</strong> https://www.pf-ads.com/admin/</p>
      <p><strong>OAuth Client ID:</strong> Ov23HB9OZZ7motgK...</p>
    </div>
  </div>

  <script>
    function showDebugInfo() {
      document.getElementById('debugInfo').style.display = 'block';
    }

    // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    function initCMS() {
      console.log('üîÑ Starting CMS initialization...');
      
      // –°–∫—Ä—ã–≤–∞–µ–º loading
      document.getElementById('loadingState').style.display = 'none';
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ CMS –∑–∞–≥—Ä—É–∂–µ–Ω
      if (typeof CMS === 'undefined') {
        console.error('‚ùå CMS script not loaded');
        showError('CMS script failed to load');
        return;
      }
      
      try {
        console.log('‚úÖ CMS loaded, initializing...');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º CMS
        CMS.init();
        
        console.log('‚úÖ CMS initialized successfully');
        
      } catch (error) {
        console.error('‚ùå CMS initialization error:', error);
        showError('CMS initialization failed: ' + error.message);
      }
    }
    
    function showError(message) {
      console.error('Showing error:', message);
      document.getElementById('loadingState').style.display = 'none';
      document.getElementById('errorState').style.display = 'flex';
    }

    // –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ 1: –ñ–¥–µ–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('load', function() {
      console.log('üìÑ Page fully loaded');
      setTimeout(initCMS, 100);
    });

    // –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ 2: –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 100ms
    let checkCount = 0;
    const maxChecks = 50; // 5 —Å–µ–∫—É–Ω–¥ –º–∞–∫—Å–∏–º—É–º
    
    const checkInterval = setInterval(function() {
      checkCount++;
      
      if (typeof CMS !== 'undefined') {
        clearInterval(checkInterval);
        console.log(`‚úÖ CMS detected after ${checkCount} checks`);
        initCMS();
      }
      
      if (checkCount >= maxChecks) {
        clearInterval(checkInterval);
        console.error('‚ùå CMS timeout - script not loaded');
        showError('CMS script loading timeout');
      }
    }, 100);

    // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
    const style = document.createElement('style');
    style.textContent = `
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
